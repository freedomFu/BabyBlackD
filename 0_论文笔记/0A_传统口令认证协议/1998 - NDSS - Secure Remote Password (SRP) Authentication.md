> 1998 - NDSS - Secure Remote Password (SRP) Authentication 安全远程口令鉴别
>
> **摘要：**本文提出了一种新的口令鉴别和密钥交换的协议，可以在不可信的网络中做用户鉴别和密钥交换，可以抵抗字典攻击，也可以提供完美前向安全性。口令在数据库中存储的方式与口令本身是**不明文对等**的（plaintext-equivalent），即使可以破解口令数据库也无法直接用于攻击。新的协议结合零知识证明、非对称密钥交换并提供了更高的性能。
>
> **优点：**
>
> **缺点：**

## 前言

本文描述口令鉴别中的 *direct password authentication*，它具有一些特征：

- 不依赖于客户端存储的永久信息，客户端只拥有用户的口令
- 客户端和服务器之间的网络可能被敌手窃听或恶意篡改
- 没有可信第三方作为中间人来帮助客户端和服务器进行网络交互，协议的参与方只有客户端和服务器两者

此类口令鉴别方式由于需要生物特征或token，其中一个应用是远程口令保护的服务器。尽管存在很多新出的鉴别机制，口令鉴别协议的增强依然可以提高系统整体的强度。

client和server分别代表用户user和服务器host的实体。password和verifier分别代表私钥和公钥，password比通常定义的私钥要低熵，verifier是与公钥有类似的数学属性，它可以从password中计算出来，但是从verifier中计算password是比较困难的。verifier是一个服务器存储的*秘密*信息，只需要verifier来进行验证的机制称为verifier-based机制，而需要存储口令相关信息的为 *plaintext-equivalent*的机制，一旦服务器被破坏，大规模的口令信息就会被泄露。

基于零知识，可以让协议不会泄露任何关于口令的信息，而且不存储口令明文对等的信息可以保证内部攻击无法直接获取口令。

本文研究的重点就是避免 *plaintext-quivalent*机制，同时如果可以改善性能是更好的。

## 新框架

设计一个 *verifier-based*的协议比设计共享密钥的鉴别方式是更加困难的，由于password和verifier是不相等，所以协议是不对称的，只有一部分数学操作可以用于该协议，所以这种协议比较罕见。比如说电子签名或二级单侧密钥交换。

### AKE

#### 不需要加密带来好处

- 通过省略协商公共加密算法的过程来简化协议
- 避免了加密过程的脆弱性带来的安全性影响
- 避免了加密算法法律约束或使用权带来的影响

#### 协议细节

AKE采用的是 **swapped-secret** 的方法，一方计算secret，然后执行单向函数来生成 verifier并提供给另外一个实体，而且在有服务器的情况下，只需要一方实体生成secret并计算verifier即可。*verifier*也应防止字典攻击，而在传输过程中，无需 *verifier* 大大提高了系统的安全性。

存在一个等式1，该等式是AKE必须要满足的，这要求选择较好的函数才可以，例如$P()$为安全的单向函数，不能通过$P(x)$计算出$x$。此后双方可以执行密钥交换协议，验证会话密钥是否相等并继续后续的会话。

$(∀w,x,y,z)---S(R(P(w),P(x)),Q(y,z))=S(R(P(y),P(z)),Q(w,x))$

### Secure Remote Password 

![image](https://user-images.githubusercontent.com/40269368/158005913-f432312a-99d6-4392-ac91-3e30d683d390.png)

---

## 安全分析

只要口令和软件函数是恰当选取的，双方可以正确协商会话密钥，则AKE和SRP在以下情况下是正确的。可是如何证明协议是正确的，这一点还是比较困难的。（这一点也是本文提出的SRP协议不好的一点。）一个想要拦截双方会话的敌手，它一定不能只通过窃听一个成功执行的协议流程来成功访问到主机。对于SRP，本文提出通过如下的方式进一步加强定义：

1. 在一个成功的执行过程中，有关口令或相应的私钥x的有用信息都不会被揭露出来。敌手无法进行猜测和验证
2. 窃听者无法通过成功的会话来获取会话密钥K的有效信息。但是K实际上是一个高熵的值，只要算不出来即可。
3. 即使敌手有能力来篡改信息，它也不能成功访问服务器或获取口令、会话密钥的消息。在最糟糕的情况中，敌手也只能造成DoS攻击。
4. 如果敌手获取到了口令的验证值v，它也只能通过代价很大的字典攻击搜索来模仿合法用户。
5. 之前的会话密钥如果被破坏，敌手无法从其中获取任何口令信息。
6. 如果口令被敌手获取了，敌手也无法获知过去会话密钥的信息。当前会话应该可以抵抗窃听攻击。

拥有这几个属性的协议称为该协议具备鲁棒性。即便有实体不是非常可靠和安全，该协议也是可信的。敌手如果获取了用户口令，遭受进一步攻击的风险应该随着用户更改口令而消失，即要保证前向安全性。

### 归约为Diffie-Hellman

SRP协议的数学结构与DH问题相似，在数学上是一个难解问题，这使SRP可以抵抗窃听攻击，可以将SRP归约到DH问题。

### 抵抗Denning-Sacco攻击

敌手通过窃听会话捕获到会话密钥$K$，直接模仿用户或通过暴力搜索用户的口令。但敌手无法通过猜测口令来做有意义的对会话密钥K的猜测。

### 抵抗主动攻击

通过上述分析，仍然不知道这些协议是否可以成功抵御这些攻击，尽管当前不知道有什么攻击可以击破SRP，但是总是需要一个更好地形式化分析。主动攻击实际上取决于敌手可以获取什么信息。

### 安全假设和约束

#### 离散对数

$P(x) = g^x$必须是不可逆的，需要保证$n$值足够大

#### 群参数协商

$n=2p+1$，其中$p$也为素数

#### 约束检查

客户端检查，n是一个大的安全的素数，g是$GF(n)$的本原根，$B≠0$

服务器检查$A≠0$

需要检查$a,b>log_g{n}$

## 最优化SRP

SRP的实际应用带来了性能的问题。消息的轮数、交换消息的大小、以及期待成功鉴别的执行时间。

如果可以省略一个网络消息或计算轮数，则可以较好地改善性能。

### 消息轮数

### 执行速度













