### 文章内容介绍

> 2014 - 密码学报 - 基于PKI的认证密钥协商协议可证明安全理论研究
>
> **关键词：**信息安全；密钥协商；可证明安全；安全目标；随机语言模型
>
> **老师批注**：指出AKE协议设计原则，三种形式化方法，提及PAKE - 3PAKE - ROM -eCK

#### 术语

> `key establishment` 密钥建立
>
> `key agreement` 密钥协商
>
> `authenticated key agreement AKA` 认证密钥协商

### 总结、评价与应用

这篇文章是2014年发表于密码学报中有关认证密钥协商协议可证明安全理论研究的综述文章，对于入门该领域的学生比较友好。

- 根据参与者长期私钥的性质对密钥协商协议进行了分类
- 对于基于PKI体系的密钥协商协议进行了介绍，包括双方、三方口令和群密钥协商的方案，优缺点及改进方案
- 提炼出设计密钥协商协议的基本原则及达到的安全目标
- 介绍了安全论证方法，引出可证明安全理论
- 可证明安全理论的研究进展，存在的问题和进一步发展前景

### 文章背景及主要贡献？

#### 研究内容和文章脉络

本文围绕基于PKI的认证密钥协商协议及其安全性分析理论展开研究

- 首先根据*参与者长期私钥的不同性质*对密钥协商协议进行了分类
- 之后介绍基于PKI体系的密钥协商协议 （着重讲认证密钥协商协议 AKA）
	- 双方、三方口令和群密钥协商协议的研究现状
	- 这些方案的优缺点和对应的改进方案
	- 提炼出设计这类密钥协商协议的基本原则以及应达到的安全目标
- 总结了现有的密钥协商协议的安全性论证方法，重点论述了可证明安全理论在双方，三方口令和群认证密钥协商中的研究进展
- 对当前密钥协商协议中存在的问题进行了总结和归纳

> 文章提及了很多背景知识和历史研究，理清思路可以对这个领域有更好的认识

### 文章最后的结论

1. 明确了安全目标是设计安全协议的首要条件，如果一个协议制定了明确的安全目标并达到了预期，那么该协议在这些目标下就是安全的，即使分析者发现了安全目标之外的安全漏洞，也只应说协议未考虑这一漏洞，而不应否认协议自身的安全性
2. 总结了密钥协商协议的安全论证方法，对其进行了分类，引出了可证明安全理论
3. 介绍了近年来双方、三方口令和群密钥协商的可证明安全理论的研究进展，说明了这些模型之间的联系与各自存在的问题

### 思想脉络

#### 文章结构（无需整理到纸质笔记中）

- 1 引言
	- 1.1 认证密钥协商协议的*分类*
	- 1.2 密钥协商协议的*发展概述*
		- 1.2.1 2AKA协议的研究现状
		- 1.2.2 3PAKA协议的研究现状
		- 1.2.3 GAKA协议的研究现状
- 2 密钥协商协议的*设计原则和安全目标*
	- 2.1 协议的设计原则
	- 2.2 密钥协商协议中可能的攻击 （中国密码学报告2008年密码协议文章也有涉及）
		- 2.2.1 密钥协商中可能的攻击
		- 2.2.2 认证密钥协商协议应实现的安全目标
- 3 密钥协商协议的*安全性论证方法*
- 4 密钥协商协议的*可证明安全理论研究进展*
	- 4.1 2AKA协议的可证明安全理论研究进展
	- 4.2 3PAKA协议的可证明安全理论研究进展
	- 4.3 GAKA协议的可证明安全理论研究进展
- 5 密钥协商协议中有待研究的*问题*
	- 5.1 更强的安全模型和更为高效的协议
	- 5.2 适合复杂应用环境的安全协议设计
	- 5.3 现实世界中使用的复杂协议安全性分析
- 6 结束语

#### 思想脉络

> 每个小标题下的关键句

##### 1. 引言

**密码协议** 密码协议是一种抽象或具体的协议，它执行与安全相关的功能并应用密码算法，通常作为密码原语序列。协议一般描述了如何使用这些算法，包含了相关的数据结构和表现形式。它广泛应用于应用层数据传输，可以用于以下的方面：

- 密钥协商或建立
- 实体鉴别
- 对称加密和消息鉴别
- 安全应用级数据传输
- 不可否认
- 密钥共享
- 安全多方计算

> 不严格地说，密码协议就是在消息处理环节采用了若干密码算法的协议，它是在密码算法的基础上为各种实际应用系统而设计的基于密码算法的交互方案

**密钥建立（key establishment）协议**是密码协议的一个重要分支，主要作用是为两个或多个参与者在公开的网络上建立临时的秘密会话密钥

- 保证后续通信安全的重要机制，利用密钥建立协议得到会话密钥，参与者可以在开放的网络中建立安全信道，保证传输信息的安全性
- 会话密钥是短期密钥，只应用于本次会话，使用短期会话密钥可以限制攻击者可能得到的有效密文的数量，减少由于会话密钥丢失造成的消息泄露带来的损失；临时会话密钥还可以保证不相关的会话是相互独立的

> 密钥建立协议是密码学的基本组件，也是在不安全的网络上建立安全信道的最基本的需求

根据会话密钥生成方式不同，key establishment 通常分为两种：

- 密钥分配 key distribution, KD 协议
	- 密钥的分发者生成一个会话密钥并将其通过安全信道秘密地发送给各个参与者
	- 简单，一些场合如参与者不能同时在场，必须依赖此协议
	- 接收会话密钥的参与者必须信任密钥分发者或必须存在一个可信第三方，要求在现实中比较难以实现，或需要较高成本；维护安全信道也需要较高成本
- 密钥协商 key agreement, KA 协议
	- 会话密钥由所有参与者共同协商而成，任何一方在协商结束前都无法预测或决定会话密钥的值
	- 计算量和通信量较大，但不需要可信第三方和安全信道，协议参与者也不需要额外信任其他参与者

> 如果协议的参与者可以确信，除了指定的实体之外，其他任何参与者都不能得到秘密的会话密钥→ **认证密钥协商 （authenticated key agreement, AKA**）协议 

###### 1.1 认证密钥协商协议的分类

密钥协商协议在现实中的应用很多，它是密码学和高层综合通信协议的基本构成模块

**问题的引出：** 如何构建安全和高效的密钥协商协议一直是研究热点

Diffie-Hellman协议是第一个真正意义上的密钥协商协议，但是未对参与者进行身份认证，容易受到中间人攻击；为了弥补这个漏洞，学者提出了认证密钥协商协议。

- 使在由敌手控制的不安全网络中通信的参与者在建立临时会话密钥的同时，保证除合法参与者之外的其他实体都无法获取关于本次会话密钥的任何信息

**根据参与者长期私钥的不同性质**，密钥协商协议可以 **分为**：

- 基于PKI的密钥协商协议	
	- 每个参与者都拥有一对长期公私钥对，也拥有一对临时公私钥对，假设每个参与者事先知道其它参与者公钥
	- 协议开始时交换临时公钥，利用各自的长期私钥和临时公钥，通过某种方式的计算获得相同的会话密钥
	- 目前应用最广泛，但是成本比较高，而且技术相对复杂

- 基于身份的密钥协商协议
	- 将用户的身份信息作为公钥，系统不需要为参与者分发公钥证书


进一步地，根据参与者个数不同，密钥协商可分为：

- 双方密钥协商（2AKA）协议
- 三方密钥协商（3AKA）协议
	- 有第三方参与的双方密钥协商协议 （有一个可信或半可信的第三方帮助双方参与者生成会话密钥）
		- 可信第三方：忠实地执行协议流程，且允许掌握会话密钥
		- 半可信第三方：第三方会忠实地执行协议流程，不允许其获得会话密钥或可计算得到会话密钥的相关信息
	- 使用口令作为参与者的长期私钥是一种常见且重要的实现形式
- 群密钥协商（GAKA）协议

> 本文将重点关注双方密钥协商、三方口令密钥协商（three-party password-based AKA, 3PAKA）和群密钥协商协议的安全性理论问题。

###### 1.2 密钥协商协议的发展概述

> 对上述基于PKI的三种密钥协商协议的研究现状进行了介绍
>
> - 这里的重点放在第二个部分，**3PAKA协议的研究现状**

**2AKA协议的研究现状**

```shell
1976	Diffie-Hellman	密钥协商的第一个实际的解决方案	安全性取决于计算性Diffie-Hellman问题的难解性(CDH)	抵抗被动窃听而不能抵抗主动攻击，不提供认证
			|
			| (学者们围绕它展开研究)
			|
1986	MTI三人扩展了DH协议，提出MTI/(A0,B0,C0)，不需要签名，为通信双方产生能抵抗被动攻击的双向认证的会话密钥
			|
			|(LMV指出MTI系列协议的漏洞，A0和C0容易遭受小子群攻击和未知密钥共享攻击)
			|
2003	LMV提出高效的可认证密钥协商协议MQV，被许多权威机构采纳为密码标准(安全和计算效率↑)
			|
			|(Krawczyk 指出MQV协议存在不能抵抗未知密钥共享攻击、密钥泄露伪装攻击、素数序检测等攻击)
			|
2005	Krawczyk发表HMQV，在CK模型在进行了严格的形式化安全论证
			|
			|
			|
2006	LM提出KEA+协议，提出KEA存在未知密钥共享攻击，并进行了改进
			|
			|
			|
2013	姚和赵在HMQV基础上提出不可延展的联合知识证明(NMJPOK)并设计OAKE协议，综合了HMQV和KEA协议的优点
```

**3PAKA协议的研究现状**

> 这个部分是要观看的重点，是口令传统认证协议的重点文章的发展脉络，尽管内容只是截止到作者文章发表的2014年，但对于进入这个领域应该足够了

在口令认证密钥协商协议中，参与者使用一个低熵的口令来实现身份认证与密钥协商

- 这种方式避免了一般认证密钥协商要求存在公钥基础设施或要求用户存储长对称密钥的安全硬件等前提假设，提高了使用的便利性
- 口令空间一般较小，容易被穷尽搜索等，因此PAKA的设计比基于其他PKI的密钥协商协议的设计面临更大的挑战，存在更多困难

> 标**红**的是第一阶段老师推荐的内容
>
> 以下是**传统的口令认证密钥协商协议**
>
> *1992*	BM提出一种基于用户口令的双方加密密钥协商(EKE)协议 领域开山之作?
>
> ​			**[Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks]**
>
> *2003*	Bresson(2004)提出 AuthA协议，使用Diffie-Hellman交换两条消息中的一条，实现了对用户的单向认证 
>
> ​			**[Security proofs for an efficient password-based key exchange]**
>
> ​			**[New security results on encrypted key exchange]**
>
> *2002*	PAK协议簇，被IEEE收录在国际标准IEEE P1363.2中
>
> ​			[The PAK suite: Protocols for password-authenticated key exchange]
>
> *2005*	Abdalla利用口令作为指数计算得到的随机群元素作为DH消息的掩码替代EKE协议中的理想密码，得到简单高效的EKE协议变体
>
> ​			[Simple password-based encrypted key exchange protocols]
>
> > **一些工作尝试不采用需要模型化为随机语言(RO)的Hash函数作为组件，设计能在标准模型下证明安全的双方口令协议**
>
> *2001*	KOY协议
>
> ​			[Efficient password-authenticated key exchange using human-memorable passwords]
>
> *2003*	Gennaro利用平滑投射Hash函数等抽象的一般框架及后续改进
>
> ​			[A framework for password-based authenticated key exchange]
>
> ​			[Faster and shorter password-authenticated key exchange] 2008
>
> ​			[New techniques for SPHFs and efficient one-round PAKE protocols] 2013
>
> *2014*	对PAKE的综述，表明以上协议非常适用于 *客户-服务器* 结构，但不适用于 *客户-客户*结构
>
> ​			[Password-based authenticated key exchange: an overview] 
>
> 以上协议不适用于C-C结构，网络规模扩大，用户记忆的口令数量随着与之通信的实体数量增加而增加，限制了协议的推广；**三方口令认证密钥协商**被提出，引入一个可信或者半可信的服务器，每个用户只需与该服务器共享自己的口令，服务器认证通信双方并帮助持有不同口令参与者生成会话密钥
>
> *1995*	Steiner首次提出三方口令认证密钥协商协议，并证明了安全性
>
> *2000*	Lin等人发现上述协议不仅容易受到在线不可检测字典攻击还容易受到离线字典攻击，提出LSH-3PAKE，利用可信第三方公钥加密消息的方法来抵抗上述攻击
>
> ​			[Three-party encrypted key exchange: attacks and a solution]
>
> *2001*	Lin等人又提出了新的不使用可信第三方公钥的三方口令认证密钥协商协议 LSSH-3PAKE
>
> ​			[Three-party encrypted key exchange without server public-keys]
>
> *2004*	Chang等人提出了新的不使用可信第三方公钥，并集合了LSH-3PAKE和LSSH-3PAKE优点的高效三方口令认证密钥协商协议；该协议仍然无法抵抗在线不可检测字典攻击
>
> ​			[A novel three-party encrypted key exchange protocol]
>
> *2008*	Chen等人提出CLC方案，最大优点是无需在服务器端保存参与者的口令，避免了针对服务器以获取其保存的口令的攻击
>
> ​			[A round-and computation-efficient three-party authenticated key exchange protocol]
>
> *2009*	学者指出CLC不能抵抗在线不可检测字典攻击
>
> ​			[Cryptanalysis of two three-party encrypted key exchange protocol]
>
> *2012*	学者发现CLC协议中的验证值泄露后将会导致中间值攻击，而且验证值保存在存储卡中，极易丢失或被盗
>
> ​			[Security analysis and enhancement for three-party password-based authenticated key exchange protocol]
>
> *2011*	Chang等人提出高效的3PAKE → CHY-3PAKE 不需要服务器拥有公钥，避免了使用在证明中经常被模型化理想密码（Ideal Cipher）的对称加密算法，采用异或运算，提高了所设计协议在实际系统中部署的便利性和计算通信效率
>
> ​			[A communication-efficient three-party PAKE Protocol]
>
> ​			直接将口令和一个群元素进行异或运算导致了CHY-3PAKE协议容易遭到划分攻击，攻击者通过被动窃听到的协议消息将口令空间划分为可行口令和不可行口令子空间
>
> ​			窃听到足够的协议消息后可以恢复出用户的正确口令（或限制在要给小的子空间中）
>
> *2012*
>
> *2013*
>
> ​			提出了针对CHY-3PAKE协议的改进协议，通过口令映射到Diffie-Hellman公钥所基于的群众的元素 避免了 现实中有较大安全威胁的攻击方法



**GAKA协议的研究现状**

```shell
- 早期的群密钥协商基本上都是对DH的推广，如Ingemarsson协议、GDH协议、BCP协议、TGDH协议
1994	BD协议 首个只需两轮就可实现的群密钥协商方案，未提供认证，只能抵抗被动攻击
			|
			|
			|
2003	KY基于BD构造了一个静态的三轮群认证密钥协商协议，第一个标准模型下可证明安全的群密钥协商协议
			|
			|
			|
2004	CHL提出BD协议的双线性版本
			|
			|(研究人员发现该方案任何一个参与者的两个邻居都可联手冒充该用户)
			|
2005	DB协议，比原始的BD协议更高效，且扩展性更好
			|
			|(基于口令的GAKA协议)
			|
2002	Bresson等设计了第一个可证明安全的基于口令的GAKA协议，通信轮数不固定，执行计算不对称
			|
			|
			|
2006	Dutta提出新的基于口令的GAKA协议，其中一个用户生成消息的方式与其他用户不同，防止了利用求和冗余性实施的离线字典攻击
			|
			|(第一轮中所有用户使用相同口令加密消息使攻击者可以修改身份，重用消息形成字典攻击)
			|
2006	Abdalla基于平滑投射Hash函数设计了环形结构的基于口令的GAKA
			|
			|
			|
2007	Abdalla给出了利用双方口令协议构造基于口令的GAKA的通用方法
			|
			|
			|
2009	Abdalla提出了基于口令的GAKA的理想功能，构造了第一个UC安全的基于口令的GAKA协议，共享同一个口令的多个用户可以安全地生成相同的会话密钥
			|
			|
			|
2011	Abdalla等对上述协议进行了改进，更有效地防止密钥控制
			|
			|
			|
2009	学者提出了两个标准模型下可证明安全的单轮群密钥协商协议（2010年进行了改进，提供了前向安全性）
			|
			|(传统的群密钥协商的目的是在群成员之间建立一个共同的临时密钥以用于后续加密)
			|
2009	学者提出非对称群密钥协商的模型，并给出了一个单轮的非对称密钥协商协议，但协议不具备认证性
			|
			|
			|
2010	学者提出基于身份的非对称群密钥协商协议
			|
			|(密钥协商可扩展问题，即将协议应用到大规模网络中)
			|
1999	学者提出逻辑密钥树的概念，引入群密钥管理领域
			|
			|
			|
2000	在以上基础上集合DH协议提出了TGDH方案
			|
			|
			|
2003	学者（+2004年）将TGDH协议中的二叉树扩展为三叉树，三方之间使用Joux协议，降低了计算复杂度
```

##### 2.密钥协商协议的设计原则和安全目标

>  协议设计的设计原则和安全目标概述
>
> - 协议需要具有足够的复杂性以抵抗可能出现的攻击，但协议的简单性和经济型又是其能否应用于低层网络环境中的重要衡量指标
>
> **设计满足安全性、有效性和公平性要求的协议并非易事**

###### 2.1 协议的设计原则

**基本原则**

- 要有明确的安全目标

	协议设计之初，应首先确定协议的设计目的，根据协议需求制定安全目标。明确的安全目标是保证协议设计达到既定要求的首要条件，也是在确保协议安全的前提下尽可能实现效率的重要手段

	> **Note** 如果一个协议制定了明确的安全目标并达到了这些预期，那么该协议在这些目标下就是安全的，即使分析者发现了安全目标之外的安全漏洞，也只应说协议未考虑这一漏洞，而不应否认协议自身的安全性，这也是制定明确的安全目标的意义之一
	>
	> - 设计者不应为了避免分析者的攻击而放弃协议必须拥有的安全属性

- 尽量减少使用时间戳

	以往安全协议设计中，人们多采用同步方法，需要系统维持一个时间服务器以应对参与者对其他实体的身份认证和消息新鲜性验证的请求。随着协议的广泛应用，这种要求在很多实际的网络环境中很难实现，而且维护时间服务器代价高昂。建议设计安全协议尽可能采用异步手段，使用随机数取代时间戳

- 具有尽可能小的计算复杂度和尽可能短的消息长度

	协议构造过程中，应注意协议中包含的密码消息要尽可能短，而且消息尽可能简单，尽量少用密码运算。降低了消息泄露导致会话密钥等秘密信息被破解的风险，也提高了协议的效率和适应能力，以期协议技能在数据处理和传输能力比较强的环境中使用，也能够在智能卡等计算资源有限的环境中使用

- 极可能少的安全假设

	进行协议构造时，设计者通常需要首先对网络环境进行风险评估，做出恰当的初始安全假设：各通信实体应相信各自产生的密钥是完善的或参与密钥协商的服务器是可信的等。初始假设越多，协议的安全性就越差，应当尽可能减少初始安全假设的数目

	> HMQV ： 一个好的密钥协商协议并不是不允许攻破的协议，而是在设计过程中将敌手攻击能力限制在尽可能小的范围内的协议
	>
	> 原文：While resistance to guessing attacks and impersonation attacks are basic and obvious security requirements, it is worth expanding on the meaning of the other attacks. They all represent  realizations of the same fundamental security principle: **a good security system is not one that  denies the possibility of failures but rather one designed to confine the adverse effects of such failures to the possible minimum.** 
	>
	> 一个好的安全系统不是否认所有故障的可能性，而是将这种故障的不利影响限制到可能的最小。（即让攻击者的攻击对密码协议的影响越小越好）

###### 2.2 密钥协商协议的安全目标

合理的安全目标是设计安全协议的首要条件

**密钥协商中可能的攻击**

> 攻击者攻击成功的*标志*：协议的攻击者可以在窃听、一定的计算或是与参与者进行交互后能够攻破最初定义的安全目标，就认为攻击者成功地对协议进行了攻击
>
> 根据攻击者攻击手段的不同，将针对协议的攻击分为两类：
>
> - 被动攻击：攻击者只能对参与者的通信内容进行窃听；不能被检测，只能防范
> - 主动攻击：攻击者允许对协议过程中的信息进行修改、删除或添加，甚至可以控制参与的一方或多方；可以被检测
>
> **被动攻击**
>
> *窃听攻击*		敌手可以窃听协议中传输的信息。传统检测手段几乎无法察觉，为了避免这种攻击，通常采用密码技术保护机密信息
>
> **主动攻击**
>
> *篡改攻击*		敌手可以拦截协议中发送的信息并经篡改后发送给接收方。为了防止这种攻击，应采取密码技术确保消息的完整性
>
> *重放攻击*		敌手可以插入（重放）部分之前或并行协议运行中发送过的消息。为了防止这种攻击，一般在协议的发送信息中置入新鲜值如随机数或时间戳来确保协议信息的新鲜性（**反射攻击**）
>
> *类型攻击*		在任何协议运行中，如果敌手把一种类型的消息字段替换成了另一种类型的消息字段则称为类型攻击。为了防止这种攻击，应尽量改变消息元素在每次使用中的顺序
>
> *交互攻击*		敌手设法选择一个协议，并与已知协议进行交互，为了防止这种攻击，应在协议消息认证部分加入协议的标识信息。
>
> **字典攻击**		口令密钥协商中，由于用户口令的低熵性，容易遭到针对用户口令的**字典攻击**。敌手采用遍历的方式穷举字典集合中的所有口令，并逐个进行验证。**分类根据敌手验证口令方式不同**：
>
> *离线字典攻击*		攻击者根据得到的数据离线对用户口令进行猜测和验证，不需要相应客户和服务器的参与，对PAKE危害最大。为了防止，应在协议设计之初避免公开可用于口令验证的信息
>
> *在线不可检测字典攻击*		在这种攻击中，敌手试图用猜测的口令伪造消息参与协议运行，根据服务器返回的消息验证猜测的正确性，但这一过程不能被服务器察觉。应在设计中实现显式认证
>
> *在线可检测字典攻击*			这一过程可以被服务器察觉，是PAKE本质上不可避免的一种攻击，因为敌手总可以利用一个猜测的口令冒充合法用户运行协议，若正确则获得密钥，否则排除
>
> ​												通过限制口令验证的次数，可有效降低这种攻击的风险

**协议应实现的安全目标**

- *隐式认证*         指协议的参与者（可能包括服务器）可以确保除了指定实体外，其他任何实体都不能得到会话密钥

- *密钥协商*         保证了经过隐式认证的实体可以唯一确定地获得会话密钥
- *密钥确认*         协议的参与者可以确认其它合法的实体可以得到本次协商的会话密钥。
	- HMQV指出：任何两轮的基于公钥的认证密钥协商都不可能实现密钥确认的性质。如果协议需要得到这一安全目标，则需要单独增加一轮通信
- *显式认证*         如果一个KA协议既能实现隐式认证又能实现密钥确认，则具备显式认证的性质
- *已知密钥安全*  即使敌手已经知道了除当前会话之外的会话密钥，也不会影响当前会话的安全（标准需求之一）
- *前向安全性*     如果协议参与者的长期私钥被敌手获得，而敌手不能由此求出参与者在私钥泄露前协商获得的会话密钥的话，则协议具有前向安全性
	- 完美前向安全性：如果长期私钥泄露前的会话受到了敌手的破坏（攻击者获得了参与者的长期私钥，并为其选择了这次会话的临时私钥），敌手扔无法获得这次会话的会话密钥
	- 弱的完美前向安全性：协议只能保证敌手在获得参与者的长期私钥后，之前那些未被敌手破坏的会话密钥不能被敌手蝴蝶
	- HMQV指出：基于公钥的两轮的双方认证密钥协商协议都无法实现完美前向安全性，只能实现弱的完美前向安全性

- *抗密钥泄露伪装攻击*        假设实体A和B是协议的两个参与者，当A的长期私钥被敌手获取后，该敌手可以冒充A与其他协议参与者通信；如果能够抵抗这种攻击，则这一密钥泄露不能使得敌手反过来向实体A冒充为其他参与者
- *抗未知密钥共享攻击*        某些情况下，敌手未必能得到会话密钥相关的秘密信息，但可欺骗实体关于其对等身份的信息。如果敌手成功对A和B发动攻击，A就会认为自己与B建立了共享的会话密钥，而B认为自己与敌手建立了会话密钥。导致参与者把信息发给错误的实体，或者接收数据并认为它来自一个错误的参与者
- *抗离线字典攻击*        本质上，口令认证密钥协商不能抵抗在线可检测字典攻击，但可要求口令认证密钥协商能抵抗离线字典攻击，保证攻击者必须和协议交互才能对口令猜测予以验证。此时攻击者成功的概率不会依赖于其离线的计算能力，而是依赖于其与协议参与者进行交互的次数
- *相对服务器的会话密钥私密性*        在有服务器参与的口令密钥协商中，分别与服务器共享口令的两个用户不能直接地安全通信，需要服务器协助才能实现密钥协商，要求服务器是可信的
	- 设计过程中，应尽可能降低对服务器的信任和依赖程度，即要求即使协助用户进行密钥协商，服务器也不能得到最终的会话密钥

##### 3 密钥协商协议的安全性论证方法

密钥协商的**目的**：在不可靠或充满恶意的通信环境下实现参与者的安全会话

- 这种环境下存在多种多样的攻击方式，可以是数学上的或物理上的；可以利用通信手段的缺陷，也可以利用协议本身的漏洞；攻击者允许截获、修改和删除规定的通信信息，也允许控制一个或多个参与者；加入任何可能的消息，把协议的消息转向其它接收者
- 攻击手段隐晦而多样，分析密钥协商协议安全的复杂性

> **分析密钥协商协议安全性的手段主要有两种**
>
> *启发式手段*	分析者根据自己的经验和相关知识，利用自己掌握的攻击手段考察或验证协议的安全性，从协议的交互过程中寻找安全漏洞
>
>    -    根据既定的安全目标，提出一种协议，并公开接受分析者的安全性分析即可
>
>    -    弊端
>
> 	- 新的分析技术层出不穷，在任何时候都有可能提出新的分析技术
> 	- 此做法让我们很难相信协议真正的安全性
>
> 	> 一旦协议被新的攻击方法攻破，该协议或者需要修改，或被彻底摒弃，即使修改后可以达到安全要求，但这种反复的修补也增加了人们对安全的担心
>
> *公理化手段*   准确刻画参与者和敌手特征的形式化安全模型，并在该模型下讨论协议的安全性；它一般使用数学方法构造安全证明过程，说明待论证的协议达到了安全目标：分析者首先需要建立一个安全模型，通过该模型定义协议的参与者以及参与者之间的互信关系、协议的安全参数和协议的通信环境等，模型还应定义敌手环境并为协议设定符合实际情况的具体的安全目标。分为三种：
>
> - 基于信息论（Information theoretic-based）的手段
> 	- 假设敌手有无线的计算能力和计算资源，信息论安全的协议也往往被称为无条件安全的
> - 基于计算复杂性（computational-based）的手段
> 	- 对敌手的计算能力和计算资源有所限制，更符合实际情况：如果不计成本地攻击某协议，消耗的成本比获得的秘密信息的价值还高的话是没有意义的
> 	- 这种论证方法通常将协议S的安全性归约到另一个问题P的难解性上，如果S的安全性攻破，那么就有办法解决P；如果P的难解性被公认为是成立的，那么就可以保证S的安全性没有问题
> 	- 被称为 **可证明安全** 的手段  （该方法目前大多数人认为最可靠的安全性论证手段）
> 		- 可证明安全性理论应用价值很高：研究者可以避开 *极微本原* 的难解性问题研究而把精力集中在如何将协议的安全性归约到该 *极微本原* 上
> 		- 只要相信 *极微本原* 的安全性就不需要进一步分析协议即可相信其安全性
> - 基于符号（symbolic-based）的手段
> 	- 该方法利用一些特定的语法规则定义安全模型。例如BAN逻辑和串空间理论等

可证明安全理论可能存在的问题

- 安全模型规划过程中需要明确该模型会涵盖哪些攻击，而模型设计者很难在一个模型中涵盖针对协议涵盖针对协议的所有攻击
	- 设计者的知识和经验都有一定局限性，不可能将所有攻击都考虑到
	- 针对协议的攻击手段复杂晦涩，随着网络和应用环境的改变，新的攻击也会层出不穷

**每次安全模型的改进都有力地推动着协议安全性理论的发展**

##### 4 密钥协商协议的可证明安全理论研究进展

20世纪80年代初，CMR等人首先系统阐述了可证明安全性这一思想，并给出了具有可证明安全性的加密和签名方案，但以上方案的可证明安全性以严重牺牲效率为代价

20世纪90年代中，出现了 面向实际的可证明安全性 practice-oriented provable-security 的概念

- BR等人提出了 RO(random oracle, 随机预言)模型方法论

> 本文剩余部分提到的安全模型均遵循 面向实际的可证明安全性 practice-oriented provable-security 概念
>
> 面向实际的可证明安全性理论取得了巨大成功，已被国际学术界和产业界广为接受，但仍有学者对此有异议，坚持在标准模型中考虑安全性

###### 4.1 2AKA 协议的可证明安全理论研究进展

可证明安全理论用于研究密钥协商协议最初由BR发起，首次提出用于双方协议的形式化安全模型（BR模型） **鼻祖** 以及以下的`eCK`协议

- 敌手被定义为一个概率多项式时间的图灵机，控制协议参与者间的所有通信，具有控制协议启动时间、篡改、替换或删除数据等的能力
- 每个参与者可以同其它参与者并行运行多个会话，每个参与者运行的会话都标识一个oracle，敌手与合法参与者之间进行的通信是通过一组oracle交互来描述的

人们基于BR模型设计了大量密钥协商协议

> *1996*		SR将BR推广到了智能卡领域
>
> *1997*		BJM
>
> *1999*		BM 将BR模型推广到了非对称的应用环境
>
> *2001*		CK基于前人工作提出了著名的CK模型，大大简化了形式化证明的过程，但该模型不能保证协议抵抗密钥泄露伪装攻击和双方临时私钥泄露攻击，也无法确保协议的弱的完美前向安全性
>
> *2007*		LLM将数据安全属性整合为单一定义，形成了扩展的CK模型（简称eCK模型）
>
> *2009*		对eCK模型进行了改造，可以适用于基于身份的认证密钥协商协议
>
> *2011*		 对eCK模型中三向带确认的认证密钥交换协议的新鲜性定义进行了进一步的增强，引进了所谓的抗强密钥泄露伪装攻击性
>
> *2012*		 对eCK模型进行扩展，提出了两个比eCK更强并能刻画一轮密钥交换协议完美前向安全性PFS的模型，通过额外附加的签名体制对协议消息进行签名，通过额外附加的签名体制对协议消息进行签名，给出了将一般eCK模型下安全的协议转化为具有PFS安全性协议的通用方法

###### 4.2 3PAKA协议的可证明安全理论研究进展

使用口令进行认证和密钥协商的口令认证密钥协商协议在1992年就已经开始研究，但用于口令认证密钥协商的可证明安全模型直到2000年才被提出

> *2000*			BPR提出BPR模型基于BR模型，利用*不可区分性*来定义密钥安全
>
> ​					 [Authenticated key exchange secure against dictionary attacks]
>
> *2000*			BMP提出的BMP模型利用协议模拟定义会话密钥的安全性
>
> ​					 [Provably secure password-authenticated key exchange using Diffie-Hellman]
>
> **三方口令认证密钥协商的可证明安全模型方面**
>
> *2005*			AFP提出的AFP模型是首个真正意义上的三方口令认证密钥协商的安全模型
>
> ​					 AFP模型没有区分在线可检测字典攻击和在线不可检测字典攻击，视为统一的在线字典攻击，给具体方案的安全性分析造成了不变
>
> ​					 [Password-based authenticated key exchange in the three-party setting]
>
> ​					 一些研究弥补了上述不足
>
> *2006*			WH在安全模型中细分了这两种攻击，提出了针对AFP模型的改进方法（WH模型）
>
> ​					 [Efficient and provably secure generic construction of three-party password-based authenticated key exchange protocol]
>
> *2006*			CTB提出CTB模型，基于CK模型
>
> ​					 [Password based server aided key exchange]
>
> *2008*			Y指出上述模型存在缺陷，AFP模型和WH模型没有考虑前向安全，CTB模型和WH模型没有为服务器提供密钥隐私 key privacy
>
> ​					 [Efficient and strongly secure password-based server aided key exchange]
>
> ​					 AFP和CTB模型将抵抗在线不可检测字典攻击排除在外
>
> ​					 Y 进一步提出了适用于三方口令认证密钥协商的3eCK模型



**另一个值得关注的工作：通用可组合（universal composability, UC）安全框架下的安全定义和刻画**

- 在该框架下证明安全协议在与其他协议并发运行的情况下仍然是安全性，即能保证协议的组合安全性

- 框架考虑基于口令认证的协议以自然的方式保证了口令分布可以是任何形式的概率分布（不要求一定是均匀分布）

> *2005*			C等在UC框架提出了两方PAKA协议的第一个安全定义，给出了保证隐式认证的理想功能
>
> ​					 [Universally composable password-based key exchange]
>
> *2010*			G等人提出了能够保证双向显式认证安全性质的理想功能
>
> ​					[A new framework for efficient password-based AKE]
>
> *2009*			D等人在两方PAKA安全定义的基础上，在UC框架下给出了3PAKA的一个安全性定义，并给出了一个符合该定义的具体协议
>
> ​					[Universally composable three party password-based key exchange protocol]
>
> *2011*			 Y发现上述协议不能抵抗字典攻击
>
> ​					[Offline dictionary attack on a universally composable three-party password-based key exchange protocol]
>
> *2014*			Hu等人利用分拆理想的思想，在UC框架下给出了一个新的3PAKA协议的理想功能定义，额外地提供了用户和服务器之间的双向显式认证以及抵抗会话密钥控制等安全性质，进一步增强了3PAKA协议的安全模型
>
> ​					[Universally composable three-party password-authenticated key exchange with contributiveness]

###### 4.3 GAKA协议的可证明安全理论研究进展

多方密钥协商的安全模型的研究起步比较晚

> *2001*			BCPQ提出BCPQ模型，是第一个严格的群认证密钥协商的安全模型
>
> *2001*			BCP将BCPQ模型扩展到了动态的情形 BCP模型
>
> *2002*			BCP对BCP模型进行改进以使模型能将***抵抗临时信息泄露攻击***的安全属性涵盖在内 BCP+
>
> **上述模型没有考虑恶意的参与者、相互认证安全和等献性等问题**
>
> *2005*			KS提出两种安全模型KS和UC-KS模型首次考虑了恶意参与者的存在
>
> *2007*			BGS模型以及BM模型2008 对KS模型进行了改进
>
> ​					 BGS模型还解决了密钥控制和等献性的问题
>
> *2009*			G等人发现以往模型没有考虑密钥泄露伪装攻击，证明了抵抗密钥泄露伪装攻击在群密钥协商中的重要性，对一些模型进行了该攻击，提出了GBG模型
>
> *2011*			 发现GBG模型中没有包含临时私钥泄露 ephemeral key leakage 攻击，作者对GBG模型进行了改进，提出了eGBG模型并具有很多优点

##### 5 密钥协商协议中有待研究的问题

###### 5.1 更强的安全模型和更为高效的协议

- 个人隐私、金融等通过网络协议进行传输和存储，对我们使用安全协议提出了更高的安全性需求
- 计算技术的发展和攻击经验的累积使得针对安全协议的攻击者能力比过去有了极大提高，设计者需要根据不同应用场景考虑更多安全目标和更强的安全属性
	- 隐私性需求的增强使得用户需要对其身份进行部分保密 post-ID 或 完全匿名 Anonymity
	- 安全需求的提高要求我们减弱服务器是完全可信的假设，考虑服务器是半可信 Honest-but-curious 情况下的协议安全
	- 攻击者能力的增强使得临时密钥泄露攻击称为一种现实可行的安全威胁

> 如何结合用户不断增强的安全需求，为新增的安全属性建立合适的安全模型，提出具有强安全性、高计算和通信效率的密钥协商协议是该领域的基础研究问题

###### 5.2 适合复杂应用环境的安全协议设计

- 多种不同的异构网络逐步融合，越来越多的安全协议被添加以保护用户在不同场合的安全性需求，安全协议部署的深度和范围不断扩大，密钥协商协议运行环境比过去复杂
- 如何针对异构网络融合并存、多种协议并发运行的复杂应用环境，针对用户在不同的应用架构下、为不同任务提出的多种安全通信需求，设计适合的密钥协商协议
	- 对用户凭证的保护需求促使了多个服务器分布式协同对用户进行认证的分布式密钥协商协议的发展，使得部分服务器进行内部人攻击成为涵盖的问题
	- 充分考虑现实网络架构的协议需要分析**网关服务器和认证服务器**物理上分离、安全级别和功能不同所导致的安全性问题
	- 利用云计算、云存储等技术的协议需要考虑云服务提供商可能实施的攻击

###### 5.3 现实世界中使用的复杂协议安全性分析

- 能使用公理化手段进行安全性分析或证明的协议只能是安全协议的一小部分，多数是结构简单的协议
- 现实世界广泛使用的协议结构比较复杂，但缺少在合理的安全性模型和困难性问题假设下给出合理的安全性分析和证明
	- TLS/SSL协议是学者近期在ACCE安全模型下给出了较为严格和完整的安全性证明

> 如何对其他现实世界中使用的复杂安全协议进行安全性分析，给出一个较强的安全性保证、或给出这些协议潜在的安全性缺陷，是当前迫切需要解决的显示问题

##### 6 结束语

本文介绍了 面向实际的可证明安全性 模型发展现状与趋势

- 对协议的设计原则、安全目标及可证明安全理论进行了综述

得到了结论

- 明确了安全目标是设计安全协议的首要条件
- 总结了密钥协商协议的安全论证方法，进行了分类，引出了可证明安全理论
- 介绍了2AKA 3PAKA GAKA可证明安全理论的研究进展、联系和各自的问题

现有安全理论尚不成熟，如没考虑物理攻击等
